# 拥堵指数非线性方法计算公式

## 输入
- `avg_speed_kph` : 平均速度 (km/h)
- `traffic_density_vpkm` : 交通密度 (车辆/公里)
- `road_type_code` : 道路类型代码
  - 1 = 高速公路
  - 2 = 主干道
  - 3 = 次干道
  - 4 = 支路

## 固定参数
```python
# 各道路类型阻塞密度 (车辆/公里)
k_jam = {1: 150, 2: 120, 3: 100, 4: 70}

# 各道路类型阻塞速度 (km/h)
jam_speed = {1: 30, 2: 30, 3: 20, 4: 15}

# 权重参数
α = 0.4  # 速度因子权重
β = 0.6  # 密度因子权重 (α + β = 1)
```

## 计算流程
```python
# 1. 获取道路特定参数
k_jam_value = k_jam[road_type_code]
jam_speed_value = jam_speed[road_type_code]

# 2. 计算原始因子
speed_factor_raw = (1 - avg_speed_kph / jam_speed_value)
speed_factor_raw = max(0, min(1, speed_factor_raw))  # 限制在[0,1]范围

density_factor_raw = traffic_density_vpkm / k_jam_value
density_factor_raw = min(1, density_factor_raw)     # 限制上限为1

# 3. 非线性变换 (关键步骤)
speed_factor = sqrt(speed_factor_raw)
density_factor = sqrt(density_factor_raw)

# 4. 加权合成最终指数
congestion_index = α * speed_factor + β * density_factor
```

## 核心创新：平方根变换
### 数学原理
- **函数**: f(x) = √x, x ∈ [0,1]
- **效果**: 拉伸低值区间，压缩高值区间
- **目的**: 增强轻微拥堵的区分度

## 输出
- `congestion_index` : 拥堵指数 [0,1]